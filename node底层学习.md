# node启动流程

node是一个进程，那么启动进程肯定是有一个main函数的，这个main函数就在node.cc中定义

梳理了node初始化的流程，它主要干了这些事情：

1. 初始化了v8执行的环境

2. 初始化了c++的核心模块，形成一个链表，如果我们js模块想找的话就从这里面去找

3. 执行了一些启动的js，这些js在internal/bootstrap目录下，其中包括了loader.js

4. loader.js暴露出了require等等函数

5. 初始化node1的全局环境

6. 初始化了libuv，其中包括了事件循环

# 结合libuv对node性能的理解

看了下libuv可以发现，node在对于一些操作系统的调用（例如fs操作）是采用c++多线程的方式去做的，默认开启4线程，那么如果我们想加快这些系统调用的速度我们可以通过环境变量开启更多的线程。

但是我们留意到这些任务的回调函数都是通过主线程事件循环进行回调的，所以node执行回调函数的效率是低下的。

总结：所以说node是擅长做一些fs这种操作的，因为底层是多线程是做的，但是对于回调函数来说不太适应做一些操作很重的任务，因为这些回调只有主线程在跑，会阻塞的

所以说node不行我觉得就是libuv不行，是事件循环这套体系不行。

所以说我觉得node当初设计的初衷就不是用来搞服务器的。



# 继续探索的问题

1. 探索一下node的进程，cluster模块和线程是怎么实现的

2. 继续探索libuv在node中的使用，把整一套事件循环串联起来
